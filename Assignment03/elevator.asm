CPU "8085.TBL"
HOF "INT8"

ORG 9000H

; --------------------------------
; 8000H - floor
; 8001H - direction
; 8010-8012H - temporary locations
; --------------------------------

GTHEX: EQU 030EH
HXDSP: EQU 034FH
OUTPUT: EQU 0389H
CLEAR: EQU 02BEH
RDKBD: EQU 03BAH
UPDDT: EQU 044CH
UPDAD: EQU 0440H

MVI A, 01H
STA 8000H
CALL INIT

START:
  LOOP1:
    MVI A, 18H
    STA 8011H
    LDA 8012H
    CPI 00H
    JZ ELEVATE
    LDA 8012H
    DCR A
    STA 8012H
    JMP LOOP2

  LOOP2:
    MVI A, 4CH
    STA 8010H
    LDA 8011H
    CPI 00H
    JZ LOOP1
    LDA 8011H
    DCR A
    STA 8011H
    JMP LOOP3

  LOOP3:
    LDA 8010H
    CPI 00H
    JZ LOOP2
    LDA 8010H
    DCR A
    STA 8010H
    JMP LOOP3

  ELEVATE:
    LDA 8001H
    CPI 00H
    JZ INCREMENT
    JMP DECREMENT


  INCREMENT:
    MVI A, 00H
    STA 8001H
   	LDA 8000H
    CPI 80H
    JZ DECREMENT
    RLC
    STA 8000H
    CALL INIT
    JMP LOOP1


INIT:
  MVI A, 4CH
  STA 8010H
  MVI A, 18H
  STA 8011H
  STA 8012H
  CALL DISPLAY
  RET

DECREMENT:
  MVI A, 01H
  STA 8001H
  LDA 8000H
  CPI 01H
  JZ HOLD
  RRC
  STA 8000H
  CALL INIT
  JMP LOOP1

DISPLAY:
  LDA 8000H
  STA 8FF1H
  CALL UPDDT 
  RET

HOLD:
  JMP INCREMENT

